#!/usr/bin/env bash

online=1
connection () {
    nc -z 8.8.8.8 53  >/dev/null 2>&1
    online=$?
}

while [[ "$online" -eq 1 ]]; do
    connection
    sleep 0.5
done

hyprctl keyword input:follow_mouse 0
~/.local/bin/layout -n 1 -a discord -w https://twitch.tv/following
sleep 3
~/.local/bin/layout -n 2 -a inkscape
sleep 3
~/.local/bin/layout -n 3 -s vagari -w https://github.com/nosvagor/vagari
sleep 3
~/.local/bin/layout -n 4 -s dotfiles -w https://github.com/nosvagor/dotfiles
hyprctl keyword input:follow_mouse 1

ytmdesktop & disown

sleep 4.20

kill_background () {
    ps -ef | rg "$1" | rg -v rg | awk '{print $2}' | xargs kill
}

hyprctl dispatch workspace 6
mpvpaper -o "--loop --brightness=3  --contrast=6  --saturation=-50  --hue=-8 --gamma=-20" "HDMI-A-1" ~/dotfiles/resources/videos/blackhole.webm & disown
sleep 0.5
kill_background "dna"
swaylock -C "$HOME/.config/swaylock/config.conf"
mpvpaper -o "--loop --brightness=6 --contrast=9 --saturation=-16 --hue=-24" "HDMI-A-1" ~/dotfiles/resources/videos/dna.mp4 &>/dev/null & disown
sleep 0.5
kill_background "blackhole"
eval "$HOME/.local/bin/eww-open"
hyprctl dispatch workspace 5
notify-send "$USER@$HOSTNAME" "こんにちは" --icon="$HOME/dotfiles/resources/share/nosvagor.png"

exit 0
