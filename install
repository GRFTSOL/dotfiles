#!/usr/bin/env bash

DOTS="$HOME/dotfiles"

# Install paru (essential for AUR packages and my preferred pac manager): ⮯
# mkdir -vp "$HOME"/.cache/
# cd "$HOME"/.cache/ || exit 20
# git clone https://aur.archlinux.org/paru.git
# cd paru || exit 20
# makepkg -si

# Install most dependencies (that are available from official/AUR packages): ⮯
# cd "$HOME" || exit 20
# git clone https://github.com/nosvagor/dotfiles.git
# paru -S - < "$DOTS/etc/packages.lst"

# My preferred directory structure, see ~/.config/user-dirs.dirs ⮯
cd "$HOME" || exit 20
mkdir -vp downloads
mkdir -vp media/music media/images media/videos media/gifs media/screenshots media/recordings
mkdir -vp docs/templates docs/books docs/papers docs/share

# set up sddm (merely autologin to compositor, no major configs): ⮯
mkdir -vp /etc/sddm.conf.d
cp "$DOTS"/etc/sddm.conf.d/autologin.conf /etc/sddm.conf.d/autologin.conf 
cp "$DOTS"/etc/sddm.conf.d/hyprland.desktop /usr/share/wayland-sessions/hyprland.desktop
sytemctl enable sddm

# symbolically link config files: ⮯
mkdir -vp "$HOME"/.config/
ln -sfn "$DOTS"/config/* "$HOME"/.config/
ln -sfn "$DOTS"/bin/* /usr/bin

# because zsh insists on having the config file hidden: ⮯
ln -sfn "$DOTS"/config/zsh/zshrc "$HOME"/.zshrc

# cp some root config files (bluetooth, udev): ⮯
cp "$DOTS"/etc/bluetooth/main.conf /etc/bluetooth/main.conf
cp "$DOTS"/etc/udev/* /etc/udev/rules.d/
cp "$DOTS"/etc/loader.conf /boot/loader/loader.conf
systemctl enable bluetooth.service

# ensure preferred fonts are installed: ⮯
tar -xzvf "$DOTS/fonts.tar.gz" "$HOME/fonts"
mv "$HOME/fonts/" "$HOME/.local/share/"

exit 0
